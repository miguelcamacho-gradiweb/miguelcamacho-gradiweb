{{ 'productsgrid.css' | asset_url | stylesheet_tag }}

{% assign maxLimit = collections["technology"].products_count %}
{% assign maxLimit = collections["frontpage"].products_count %}

{% assign collection = collections %}
{%- comment -%}{%- endcomment -%}
{% assign technology = collections.technology.products %}
{% assign frontpage = collections.frontpage.products  %}


<input type="hidden" name="" id="insta-clientid" value="{{ collection | json}}" />

<section class="productsGrid row col-12 col-sm-10 mx-auto p-0">
    <div class="productsGrid__titule col-12 col-sm-10 mx-auto mt-3 mb-3">
        <h2>Products</h2>
    </div>
 
    <div class="preferencesProduct row mx-auto mb-3">
        <div class="preferencesProduct__collection col-12 col-sm-10 col-md-6">
            <h3>Select the collection of your preference</h3>
            <select name="selectCollection" id="selectCollectionId">
                {% for collection in collection %}
                <option value="{{ collection.id }}" >{{ collection.title}}</option>
                {% endfor %}
            </select>
        </div>


        <div class="preferencesProduct__range col-12 col-sm-10 col-md-6">
            <h3>How many products do you want to see</h3>
            <div class="preferencesProduct__range--details">
                <input id="rangeLimit" type="range" step="1" min="0" value="{{ maxLimit }}" max="{{ maxLimit }}" list="tickmarks">
                <p id="seeRange" class="ml-2">{{ maxLimit }} Products</p>
                <datalist id="tickmarks" name="{{ collection.products_count }}">
            </datalist>
            </div>
        </div>
    </div>
 

    <article class="listProduct disposition row mx-auto">
        
        {% for product in frontpage %}
            <form name="form_buy" class="col-12 col-sm-11 col-md-4 mb-2">
                <div class="product">
                    <div class="product__render">
                        <a href="{{ product.url }}">{{ product.title }}</a>
                        <img src="{{ product.featured_image | image_url }}" alt="{{ product.featured_image.alt | escape}}"
                            loading="lazy" width="200" height="200" id="{{ product.id }}">
                        <p onclick=adios()>Price: {{ product.price | money }}  </p>
                    </div>
                    <div class="product_variants">
                        {% for variant in product.variants %}
                        {% if variant.available != false %}
                        <img src="{{ variant.featured_image | image_url }}" alt="{{ variant.featured_image.alt | escape}}"
                            loading="lazy" width="50" height="50" name="{{ variant.featured_image.product_id }}" id="{{ variant.id }}">
                        {% endif %}
                        {% endfor %}
                    </div>
                    <div class="product__buy">
                        <p id="{{ product.id }}"  class="buy_car">Buy product</p>
                    </div>
                </div>
            </form>
        {% endfor %}
    </article>
</section>

<button onclick="hola3()")>hola</button>

<script src="{{ 'productsgrid.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'carbuy.js' | asset_url }}" defer="defer"></script>


<script>
    window.onload = function() {
        let collection = {{ collections | json }}
        collectionData(collection)
    }

    const newCollection = (handle)=>{
       console.log(handle)
    }

</script>


{% schema %}
{
    "name": "t:sections.main-collection-product-grid.name",
    "settings":[
        {
        "type": "range",
        "id": "id_range",
        "label": "label",
        "unit": "u",
        "min": 1,
        "max": 10,
        "step": 1,
        "default": 1
        }
    ]
}
{% endschema %}